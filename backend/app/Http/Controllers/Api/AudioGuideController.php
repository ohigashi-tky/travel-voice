<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Services\PollyService;
use Illuminate\Http\Request;
use Illuminate\Http\JsonResponse;
use Illuminate\Support\Facades\Validator;
use Illuminate\Support\Facades\Log;

class AudioGuideController extends Controller
{
    private PollyService $pollyService;

    public function __construct(PollyService $pollyService)
    {
        $this->pollyService = $pollyService;
    }

    /**
     * テキストを音声に変換
     *
     * @param Request $request
     * @return JsonResponse
     */
    public function synthesize(Request $request): JsonResponse
    {
        $validator = Validator::make($request->all(), [
            'text' => 'required|string|max:3000',
            'voice_id' => 'nullable|string|in:Takumi,Tomoko,Mizuki,Kazuha',
        ]);

        if ($validator->fails()) {
            return response()->json([
                'success' => false,
                'message' => 'バリデーションエラー',
                'errors' => $validator->errors(),
            ], 422);
        }

        try {
            $result = $this->pollyService->synthesizeSpeech(
                $request->input('text'),
                $request->input('voice_id')
            );

            return response()->json([
                'success' => true,
                'data' => $result,
                'message' => '音声合成が完了しました',
            ]);

        } catch (\Exception $e) {
            Log::error('Audio synthesis failed', [
                'text' => $request->input('text'),
                'error' => $e->getMessage(),
            ]);

            return response()->json([
                'success' => false,
                'message' => $e->getMessage(),
            ], 500);
        }
    }

    /**
     * 利用可能な音声一覧を取得
     *
     * @return JsonResponse
     */
    public function voices(): JsonResponse
    {
        try {
            $voices = $this->pollyService->getAvailableVoices();

            return response()->json([
                'success' => true,
                'data' => $voices,
            ]);

        } catch (\Exception $e) {
            Log::error('Failed to get voices', ['error' => $e->getMessage()]);

            return response()->json([
                'success' => false,
                'message' => '音声一覧の取得に失敗しました',
            ], 500);
        }
    }

    /**
     * 観光地の音声ガイドを生成
     *
     * @param Request $request
     * @return JsonResponse
     */
    public function generateTouristSpotAudio(Request $request): JsonResponse
    {
        $validator = Validator::make($request->all(), [
            'spot_id' => 'required|integer',
            'voice_id' => 'nullable|string|in:Takumi,Tomoko,Mizuki,Kazuha',
            'language' => 'nullable|string|in:ja,en',
        ]);

        if ($validator->fails()) {
            return response()->json([
                'success' => false,
                'message' => 'バリデーションエラー',
                'errors' => $validator->errors(),
            ], 422);
        }

        try {
            Log::info('Starting audio guide generation', ['spot_id' => $request->input('spot_id')]);
            // 観光地情報を取得（実際の実装では観光地モデルから取得）
            $spotData = $this->getTouristSpotData($request->input('spot_id'));
            Log::info('Tourist spot data fetch', ['spot_id' => $request->input('spot_id'), 'data_found' => $spotData !== null]);
            
            if (!$spotData) {
                return response()->json([
                    'success' => false,
                    'message' => '観光地が見つかりません',
                ], 404);
            }

            // 音声ガイド用テキストを生成
            Log::info('Spot data for audio guide generation', ['spot_data' => $spotData]);
            try {
                $guideText = $this->generateGuideText($spotData, $request->input('language', 'ja'));
                Log::info('Guide text generated successfully', ['text_length' => strlen($guideText)]);
            } catch (\Exception $e) {
                Log::error('Guide text generation failed', ['error' => $e->getMessage(), 'trace' => $e->getTraceAsString()]);
                throw $e;
            }

            // 音声合成
            $result = $this->pollyService->synthesizeSpeech(
                $guideText,
                $request->input('voice_id')
            );

            return response()->json([
                'success' => true,
                'data' => array_merge($result, [
                    'spot_id' => $request->input('spot_id'),
                    'guide_text' => $guideText,
                ]),
                'message' => '音声ガイドが生成されました',
            ]);

        } catch (\Exception $e) {
            Log::error('Tourist spot audio generation failed', [
                'spot_id' => $request->input('spot_id'),
                'error' => $e->getMessage(),
                'trace' => $e->getTraceAsString(),
            ]);

            return response()->json([
                'success' => false,
                'message' => '音声ガイドの生成に失敗しました',
            ], 500);
        }
    }

    /**
     * キャッシュをクリア（管理者用）
     *
     * @return JsonResponse
     */
    public function clearCache(): JsonResponse
    {
        try {
            $this->pollyService->clearCache();

            return response()->json([
                'success' => true,
                'message' => 'キャッシュをクリアしました',
            ]);

        } catch (\Exception $e) {
            Log::error('Failed to clear cache', ['error' => $e->getMessage()]);

            return response()->json([
                'success' => false,
                'message' => 'キャッシュのクリアに失敗しました',
            ], 500);
        }
    }

    /**
     * 観光地データを取得（仮実装）
     *
     * @param int $spotId
     * @return array|null
     */
    private function getTouristSpotData(int $spotId): ?array
    {
        // 実際の実装では観光地モデルから取得
        // 今は仮のデータを返す
        $spots = [
            // 東京都 (1-99)
            1 => [
                'id' => 1,
                'name' => '東京スカイツリー',
                'description' => '2012年に開業した世界最高クラスの電波塔。高さ634メートルを誇り、東京の新たなランドマークとして多くの人々に愛されています。',
                'history' => '平安時代、この地域は「武蔵国」と呼ばれ、江戸時代には本所・深川として発展しました。明治時代には工業地帯として栄え、戦後の復興とともに下町文化が花開いた場所です。スカイツリーの建設は2008年に始まり、最新の制震技術「心柱制振」を採用。これは五重塔の心柱からヒントを得た日本独自の技術です。',
                'episodes' => [
                    '建設中には「新東京タワー」と呼ばれていましたが、2008年の公募で「東京スカイツリー」に決定。6万件を超える応募がありました。',
                    '展望台からの眺めは晴れた日には富士山まで見えることがあり、江戸時代の浮世絵師も愛した同じ富士山を現代の高さから眺めることができます。',
                    'ライトアップは「粋」と「雅」の2パターンで交互に点灯。江戸の美意識を現代に表現しています。'
                ],
                'highlights' => ['展望デッキ（350m）', '展望回廊（450m）', '東京ソラマチ', 'すみだ水族館'],
                'cultural_significance' => '下町の伝統文化を大切にしながら、最新技術を融合させた日本の技術力の象徴',
            ],
            2 => [
                'id' => 2,
                'name' => '浅草寺',
                'description' => '東京最古の寺院。雷門で有名な浅草寺は、年間約3000万人が訪れる観光名所です。',
                'history' => '628年に創建された東京最古の寺院です。平安時代から江戸時代にかけて庶民の信仰を集め、江戸文化の中心地として栄えました。',
                'episodes' => [
                    '雷門の大提灯は高さ3.9m、直径3.3m、重さ約700kgの巨大な提灯です。',
                    '仲見世通りは日本最古の商店街の一つで、約250mの参道に90店舗が軒を連ねています。'
                ],
                'highlights' => ['雷門', '仲見世通り', '本堂', '五重塔'],
                'cultural_significance' => '江戸文化と庶民信仰の象徴として、東京の歴史を物語る重要な文化遺産',
            ],
            3 => [
                'id' => 3,
                'name' => '明治神宮',
                'description' => '明治天皇と昭憲皇太后を祀る神社。都心にありながら豊かな森に囲まれた神聖な空間です。',
                'history' => '1920年に創建された比較的新しい神社ですが、全国から献木された約10万本の樹木により、都心の貴重な緑地となっています。',
                'episodes' => [
                    '初詣の参拝者数は日本一で、正月三が日で約300万人が訪れます。',
                    '神宮の森は人工的に造られた森で、100年後の完成を目指して設計されました。'
                ],
                'highlights' => ['本殿', '明治神宮御苑', '清正井', '大鳥居'],
                'cultural_significance' => '近代日本の象徴として、自然と調和した神聖な空間を提供',
            ],
            4 => [
                'id' => 4,
                'name' => '銀座',
                'description' => '日本を代表する高級商業地区。老舗店から最新ブランドまで、洗練された街並みが魅力です。',
                'history' => '江戸時代に銀貨の鋳造所があったことから「銀座」と名付けられました。明治時代にレンガ街として整備され、日本の近代化の象徴となりました。',
                'episodes' => [
                    '銀座のメインストリート中央通りは、日曜日に歩行者天国として開放されます。',
                    '銀座のクラブは日本の夜の社交場として独特の文化を形成しています。'
                ],
                'highlights' => ['中央通り', '歌舞伎座', '築地市場', '銀座シックス'],
                'cultural_significance' => '日本の商業文化と洗練された都市文化の中心地',
            ],
            5 => [
                'id' => 5,
                'name' => '上野公園',
                'description' => '桜の名所として有名な都市公園。多くの文化施設が集まる文化の拠点でもあります。',
                'history' => '江戸時代は寛永寺の境内でしたが、明治時代に日本初の公園として整備されました。',
                'episodes' => [
                    '春には約1000本の桜が咲き誇り、日本有数の花見スポットとなります。',
                    '上野動物園は1882年開園の日本最古の動物園です。'
                ],
                'highlights' => ['桜並木', '上野動物園', '東京国立博物館', '国立科学博物館'],
                'cultural_significance' => '江戸文化から近代文化への変遷を象徴する文化的空間',
            ],
            6 => [
                'id' => 6,
                'name' => '渋谷スクランブル交差点',
                'description' => '世界で最も有名な交差点の一つ。若者文化の発信地として世界中から注目されています。',
                'history' => '戦後の復興とともに商業地として発展し、1970年代以降若者文化の中心地となりました。',
                'episodes' => [
                    '一度の青信号で最大3000人が横断する世界有数の交差点です。',
                    'ハチ公像は忠犬ハチ公の物語で世界的に有名になりました。'
                ],
                'highlights' => ['スクランブル交差点', 'ハチ公像', '渋谷センター街', '109'],
                'cultural_significance' => '現代日本の若者文化と都市文化の象徴',
            ],
        ];

        // 既存の詳細データがある場合はそれを返す
        if (isset($spots[$spotId])) {
            return $spots[$spotId];
        }

        // それ以外は generateGenericSpotData を使用
        return $this->generateGenericSpotData($spotId);
    }

    /**
     * 共通の観光地データテンプレートを生成
     */
    private function generateGenericSpotData(int $spotId): ?array
    {
        // 追加の観光地データマッピング（既存の$spotsにないもののみ）
        $detailedSpots = [
            // 埼玉県 (900-999)
            901 => [
                'name' => '川越',
                'description' => '小江戸とも呼ばれる歴史ある城下町。蔵造りの街並みと菓子屋横丁で有名です。',
                'history' => '川越は太田道灌が城を築いて以来、江戸時代には川越藩の城下町として栄えました。江戸と密接な関係を持ち、商業都市として発展したことから「小江戸」の愛称で親しまれています。',
                'episodes' => [
                    '蔵造りの街並みは江戸時代の面影を今に伝え、映画やドラマのロケ地としても人気です。',
                    '菓子屋横丁には昔ながらの駄菓子屋が軒を連ね、懐かしい雰囲気を演出しています。',
                    '川越まつりは360年以上の歴史を持ち、絢爛豪華な山車が街を練り歩きます。'
                ],
                'highlights' => ['蔵造りの街並み', '菓子屋横丁', '川越城本丸御殿', '時の鐘', '喜多院'],
                'cultural_significance' => '江戸の風情を残す小江戸として、埼玉県の歴史と文化を代表する観光地'
            ],
            902 => [
                'name' => '秩父神社',
                'description' => '秩父地方の総鎮守として2000年以上の歴史を持つ古社。左甚五郎の彫刻で有名。',
                'history' => '崇神天皇の時代（紀元前87年）に創建されたと伝えられる古社で、秩父地方の総鎮守として信仰を集めてきました。現在の社殿は徳川家康によって寄進されたものです。',
                'episodes' => [
                    '左甚五郎作の「つなぎの龍」は、夜な夜な近くの池に水を飲みに行くという伝説があります。',
                    '秩父夜祭は日本三大曳山祭りの一つで、絢爛豪華な屋台と笠鉾が街を練り歩きます。',
                    '境内には「秩父まつり会館」があり、祭りの歴史と文化を学ぶことができます。'
                ],
                'highlights' => ['左甚五郎の彫刻', '秩父夜祭', '本殿', '神楽殿', '祭り屋台'],
                'cultural_significance' => '秩父地方の信仰の中心として、伝統的な祭り文化を今に伝える重要な神社'
            ],
            903 => [
                'name' => '長瀞',
                'description' => '荒川沿いの美しい渓谷美と岩畳で有名な自然景勝地。',
                'history' => '秩父古生層が荒川の流れによって削られてできた景勝地で、国指定名勝天然記念物に指定されています。長瀞の地名は「長い淵」を意味し、その美しさは古くから多くの人を魅了してきました。',
                'episodes' => [
                    '岩畳は約1600万年前の海底が隆起してできた珍しい地形で、地質学的にも価値が高い。',
                    '長瀞ライン下りは約100年の歴史があり、四季を通じて美しい渓谷美を楽しめます。',
                    '宝登山からは秩父の山々と関東平野を一望でき、四季の花々も美しく咲き誇ります。'
                ],
                'highlights' => ['岩畳', '長瀞ライン下り', '宝登山', '月の石もみじ公園', '自然博物館'],
                'cultural_significance' => '関東地方屈指の自然景勝地として、地質学習と自然体験の貴重な場所'
            ],
            
            // 大阪府 (100-199)
            101 => [
                'name' => '大阪城',
                'description' => '豊臣秀吉が築城した名城。美しい天守閣と桜の名所として親しまれています。',
                'history' => '1583年、豊臣秀吉が石山本願寺の跡地に築城を開始。当時は「三国無双」と称される壮大な城でした。江戸時代には徳川幕府の直轄地となり、明治維新後は陸軍の施設として使用されました。現在の天守閣は昭和6年（1931年）に市民の寄付により復興されたものです。',
                'episodes' => [
                    '豊臣秀吉は大阪城を「天下統一の象徴」として建設しました。黄金の茶室で有名な茶会を開いたり、全国の大名を招いて盛大な花見を催したりしました。',
                    '現在の天守閣は戦後復興のシンボルとして、大阪市民の寄付金により再建されました。当時の大阪市民の熱い想いが込められています。',
                    '大阪城の石垣には、全国各地の大名が運んだ巨石が使われており、中には九州から運ばれた重さ130トンもの巨石もあります。'
                ],
                'highlights' => ['天守閣からの眺望', '豊臣秀吉ゆかりの歴史', '桜の名所としての美しさ', '大阪城公園'],
                'cultural_significance' => '豊臣政権の栄華を物語る日本屈指の名城として、大阪の歴史と文化の象徴'
            ],
            102 => [
                'name' => '通天閣',
                'description' => '新世界のシンボルタワー。ビリケンさんで有名な大阪を代表する観光地です。',
                'history' => '1912年に初代通天閣が建設され、当時は東洋一の高さを誇りました。戦時中に解体されましたが、1956年に現在の二代目通天閣が復活しました。',
                'episodes' => [
                    'ビリケンさんは1908年にアメリカで誕生したキャラクターですが、大阪で「幸運の神様」として親しまれるようになりました。足の裏を撫でると願いが叶うと言われています。',
                    '通天閣のライトアップは天気予報になっており、白色なら晴れ、オレンジ色なら曇り、青色なら雨を表しています。',
                    '新世界は串カツの発祥地で、「二度漬け禁止」の文化が生まれた場所でもあります。'
                ],
                'highlights' => ['展望台からの大阪の街並み', 'ビリケンさん', '新世界グルメ', 'レトロな雰囲気'],
                'cultural_significance' => '大阪の庶民文化と下町情緒を象徴する、愛され続けるランドマーク'
            ],
            103 => [
                'name' => '海遊館',
                'description' => '世界最大級の水族館。ジンベエザメやマンタが泳ぐ太平洋水槽は圧巻です。',
                'history' => '1990年に開館した世界最大級の水族館で、環太平洋の海を再現したユニークな展示で話題となりました。',
                'episodes' => [
                    '太平洋水槽は深さ9メートル、水量5,400トンの巨大水槽で、ジンベエザメが優雅に泳ぐ姿は圧巻です。',
                    '海遊館では世界で初めてジンベエザメの長期飼育に成功し、現在も研究が続けられています。',
                    '南極大陸ゾーンではペンギンたちが氷の上で暮らす様子を間近で観察できます。'
                ],
                'highlights' => ['ジンベエザメの太平洋水槽', 'ペンギンとの触れ合い', '多様な海洋生物', '体感型展示'],
                'cultural_significance' => '海洋生物の保護と教育を通じて、自然環境への理解を深める文化施設'
            ],
            104 => [
                'name' => '道頓堀',
                'description' => '大阪の台所と呼ばれる繁華街。グリコの看板やかに道楽で有名な大阪グルメの聖地。',
                'history' => '1612年に安井道頓によって開削された運河で、江戸時代から芝居小屋や茶屋が立ち並ぶ繁華街として発展しました。戦後は大阪の台所として、たこ焼きやお好み焼きなどの庶民グルメの中心地となりました。',
                'episodes' => [
                    'グリコの看板は1935年から掲げられており、現在で6代目。大阪のシンボル的存在として愛され続けています。',
                    'かに道楽の動くカニの看板は1960年から始まり、道頓堀の名物として世界的に有名になりました。',
                    '「くいだおれ太郎」は大阪の食文化を象徴するキャラクターとして親しまれています。'
                ],
                'highlights' => ['グリコの看板', 'かに道楽', 'たこ焼き店', '道頓堀川クルーズ', '法善寺横丁'],
                'cultural_significance' => '大阪の食文化と庶民エンターテイメントの中心地として、関西文化の象徴'
            ],
            105 => [
                'name' => '新世界',
                'description' => '通天閣を中心とした下町エリア。串カツの発祥地として知られる大阪の庶民文化の象徴。',
                'history' => '1903年の第5回内国勧業博覧会の跡地に開発された娯楽街で、パリをモデルにした北部とニューヨークをモデルにした南部に分かれていました。戦後は庶民的な飲食街として発展し、独特の文化を育んできました。',
                'episodes' => [
                    '串カツは新世界が発祥の地で、「二度漬け禁止」という独特のルールが生まれました。',
                    'スマートボールという昭和レトロなゲームが今も楽しめる貴重な場所です。',
                    '新世界は戦前「東洋一の歓楽街」と呼ばれるほど賑わっていました。'
                ],
                'highlights' => ['通天閣', '串カツ店', 'スマートボール', 'ビリケンさん', 'ジャンジャン横丁'],
                'cultural_significance' => '大阪の庶民文化と下町情緒を色濃く残す、昭和レトロの象徴的エリア'
            ],
            106 => [
                'name' => '大阪駅・梅田',
                'description' => '関西最大のターミナル駅を中心とした商業・ビジネス地区。',
                'history' => '1874年に大阪駅が開業し、関西の玄関口として発展してきました。戦後の復興とともに高層ビルが建ち並び、現在は西日本最大級の商業・ビジネス地区となっています。',
                'episodes' => [
                    '梅田スカイビルの空中庭園展望台は「世界の建築トップ20」に選ばれた名建築です。',
                    '阪急・阪神・JRの3つのターミナル駅が集中する日本でも珍しい地区です。',
                    '地下街は日本最大級の規模で、「ダンジョン」と呼ばれるほど複雑な構造です。'
                ],
                'highlights' => ['梅田スカイビル', '大阪駅', '地下街', 'グランフロント大阪', 'ヨドバシカメラ'],
                'cultural_significance' => '関西経済の中心地として、現代大阪の発展を象徴するビジネス・商業拠点'
            ],
            
            // 京都府 (200-299)
            201 => [
                'name' => '清水寺',
                'description' => '778年開創の古刹。有名な清水の舞台と美しい景色で知られています。',
                'history' => '778年に延鎮上人によって開創された、京都最古の寺院の一つです。平安時代以来、観音霊場として多くの人々の信仰を集めてきました。現在の本堂は1633年に再建されたもので、釘を一本も使わない伝統的な日本建築の傑作です。',
                'episodes' => [
                    '「清水の舞台から飛び降りる」という言葉の語源となった舞台は、高さ約13メートル。江戸時代には実際に飛び降りる人がいたという記録も残っています。',
                    '清水寺の音羽の滝は三筋に分かれており、学問成就・恋愛成就・長寿の三つのご利益があるとされています。',
                    '春の桜、秋の紅葉の季節には特別夜間拝観が行われ、ライトアップされた境内は幻想的な美しさです。'
                ],
                'highlights' => ['清水の舞台', '音羽の滝', '仁王門', '三重塔', '桜と紅葉'],
                'cultural_significance' => '平安時代から続く観音信仰の聖地として、京都の歴史と文化を代表する世界遺産'
            ],
            202 => [
                'name' => '金閣寺',
                'description' => '足利義満の別荘として建てられた金箔で覆われた美しい楼閣。',
                'history' => '1397年に足利義満が建立した山荘・北山殿が起源です。義満の死後、遺言により禅寺となり鹿苑寺と名付けられました。現在の建物は1955年に再建されたもので、金箔が施された美しい姿で多くの人を魅了しています。',
                'episodes' => [
                    '足利義満は中国の明朝皇帝から「日本国王」の称号を受け、この金閣で明の使節を迎えました。',
                    '1950年に放火により焼失しましたが、三島由紀夫の小説「金閣寺」のモデルにもなりました。',
                    '金閣の金箔は約20万枚が使用されており、定期的に貼り直しが行われています。'
                ],
                'highlights' => ['金箔の楼閣', '鏡湖池に映る姿', '庭園の美', '不動堂', '茶室・夕佳亭'],
                'cultural_significance' => '室町時代の北山文化を代表する建築として、日本の美意識の精髄を表現した世界遺産'
            ],
            203 => [
                'name' => '伏見稲荷大社',
                'description' => '全国の稲荷神社の総本宮。千本鳥居の美しい朱色のトンネルで有名です。',
                'history' => '711年に創建された、全国に約3万社ある稲荷神社の総本宮です。稲荷大神を祀り、五穀豊穣、商売繁昌、家内安全の神として信仰されています。',
                'episodes' => [
                    '千本鳥居は実際には約1万基あり、江戸時代以降に商売繁昌を願う人々が奉納したものです。',
                    '稲荷神のお使いである狐の像が境内各所に置かれており、口にくわえているものによって意味が異なります。',
                    '山全体が神域とされる稲荷山には、奥社奉拝所まで約2時間のハイキングコースがあります。'
                ],
                'highlights' => ['千本鳥居', '本殿', '奥社奉拝所', '稲荷山ハイキング', '狐の石像'],
                'cultural_significance' => '稲荷信仰の中心地として、日本人の商売と豊穣への願いを象徴する聖地'
            ],
            
            // 北海道 (300-399)
            301 => [
                'name' => '札幌時計台',
                'description' => '旧札幌農学校演武場として1878年に建設された北海道のシンボル。',
                'history' => '1878年に札幌農学校（現北海道大学）の演武場として建設されました。クラーク博士で有名な札幌農学校の歴史を物語る建物で、現在は札幌市の重要文化財に指定されています。',
                'episodes' => [
                    'クラーク博士の「Boys, be ambitious!」の言葉で有名な札幌農学校の象徴的建物です。',
                    '時計台の時計は1881年に設置され、140年以上にわたって正確に時を刻み続けています。',
                    '建物内部では札幌農学校の歴史や開拓時代の展示を見ることができます。'
                ],
                'highlights' => ['歴史ある時計台', '開拓時代の展示', 'クラーク博士の資料', '札幌の街並み'],
                'cultural_significance' => '北海道開拓の歴史と教育の発展を象徴する、札幌市民に愛される文化遺産'
            ],
            302 => [
                'name' => '函館山',
                'description' => '世界三大夜景の一つに数えられる美しい夜景スポット。',
                'history' => '標高334メートルの函館山は、かつて軍事要塞として使用されていました。戦後に観光地として開放され、現在は函館を代表する観光スポットとなっています。',
                'episodes' => [
                    '函館山の夜景は「100万ドルの夜景」と称され、ナポリ、香港と並んで世界三大夜景に数えられています。',
                    '函館の街は両側を海に挟まれた独特の地形で、まるで蝶が羽を広げたような美しいシルエットを描きます。',
                    'ロープウェイからの眺めも素晴らしく、津軽海峡や本州まで見渡すことができます。'
                ],
                'highlights' => ['世界三大夜景', 'ロープウェイ', '津軽海峡の眺望', '四季の自然'],
                'cultural_significance' => '函館の美しい景観と歴史を一望できる、北海道観光のハイライト'
            ],
            303 => [
                'name' => '小樽運河',
                'description' => '1923年完成の歴史ある運河。石造倉庫群とガス灯が織りなすロマンチックな景観。',
                'history' => '1923年に完成した小樽運河は、北海道の海運業の発展とともに栄えました。石造りの倉庫群は当時の繁栄を物語り、現在は観光とグルメの街として生まれ変わっています。',
                'episodes' => [
                    '運河沿いの石造倉庫群は、明治・大正時代の海運業の繁栄を物語る貴重な産業遺産です。',
                    '夕暮れ時にガス灯が灯ると、運河は幻想的な雰囲気に包まれ、多くの観光客を魅了します。',
                    '小樽は「北のウォール街」と呼ばれ、多くの銀行や商社が軒を連ねていた歴史があります。'
                ],
                'highlights' => ['石造倉庫群', 'ガス灯の夜景', '運河クルーズ', 'オルゴール館', '海鮮グルメ'],
                'cultural_significance' => '北海道開拓時代の商業都市の面影を残す、ロマンチックな歴史的景観'
            ],
            
            // 愛知県 (400-499)
            401 => [
                'name' => '名古屋城',
                'description' => '徳川家康が築いた尾張徳川家の居城。金のシャチホコで有名。',
                'history' => '1610年に徳川家康によって築城された名古屋城は、尾張徳川家62万石の居城として栄えました。天守閣は戦災で焼失しましたが、1959年に再建され、現在は名古屋市のシンボルとなっています。',
                'episodes' => [
                    '金のシャチホコは雄雌一対で、雄の方がやや大きく作られています。江戸時代には「金城温古録」で「金鯱」と記録されていました。',
                    '本丸御殿は2018年に復元が完成し、江戸時代の最高技術による豪華絢爛な装飾を見ることができます。',
                    '名古屋城は「尾張名古屋は城でもつ」と歌われるほど、名古屋の象徴として親しまれています。'
                ],
                'highlights' => ['金のシャチホコ', '本丸御殿', '名古屋城天守閣', '二之丸庭園'],
                'cultural_significance' => '尾張徳川家の威光を示す名城として、名古屋の歴史と文化の中心地'
            ],
            402 => [
                'name' => '熱田神宮',
                'description' => '三種の神器の一つ草薙神剣を祀る由緒ある神社。',
                'history' => '創建から約1900年の歴史を持つ古社で、三種の神器の一つである草薙神剣（くさなぎのみつるぎ）をご神体として祀っています。',
                'episodes' => [
                    '草薙神剣は日本武尊（やまとたけるのみこと）が東征の際に授けられた神剣で、現在も熱田神宮に祀られています。',
                    '織田信長が桶狭間の戦いの前に戦勝祈願をしたことでも有名で、信長塀という土塀が今も残っています。',
                    '年間約700万人の参拝者が訪れ、初詣の参拝者数は全国でも上位にランクされます。'
                ],
                'highlights' => ['本宮', '草薙神剣', '信長塀', '宝物館', '熱田の杜'],
                'cultural_significance' => '三種の神器を祀る格式高い神社として、日本の神道文化の中心地の一つ'
            ],
            403 => [
                'name' => 'トヨタ産業技術記念館',
                'description' => '繊維機械と自動車産業の技術革新を展示する産業博物館。',
                'history' => '1994年に開館した博物館で、トヨタグループ発祥の地である豊田自動織機製作所栄生工場の建物を活用しています。創業者豊田佐吉の発明精神と技術革新の歴史を伝える施設です。',
                'episodes' => [
                    '豊田佐吉が発明した無停止杼換装置付き豊田式汽力織機は、世界の繊維産業に革命をもたらしました。',
                    'トヨタ生産方式の基礎となる「自働化」の思想は、佐吉の織機開発から生まれました。',
                    '大正時代のレンガ造りの工場建物は、日本の産業遺産として価値が高く評価されています。'
                ],
                'highlights' => ['繊維機械館', '自動車館', '蒸気機関', '技術の系譜', '実演コーナー'],
                'cultural_significance' => '日本の産業発展とものづくり精神を象徴する技術革新の歴史館'
            ],
            
            // 福岡県 (500-599)
            501 => [
                'name' => '太宰府天満宮',
                'description' => '学問の神様菅原道真公を祀る全国天満宮の総本宮。',
                'history' => '学問の神様として親しまれる菅原道真公を祀る神社で、919年に創建されました。全国に約12,000社ある天満宮の総本宮として、多くの受験生や学生が合格祈願に訪れます。',
                'episodes' => [
                    '菅原道真公は優れた学者・政治家でしたが、左遷により太宰府で亡くなりました。その後、都で異変が続いたため、神として祀られるようになりました。',
                    '境内には道真公が愛した梅の木があり、春には美しい梅の花が咲き誇ります。',
                    '太宰府天満宮の牛の像は道真公の使いとされ、頭を撫でると頭が良くなると言われています。'
                ],
                'highlights' => ['本殿', '飛梅', '牛の銅像', '宝物殿', '梅ヶ枝餅'],
                'cultural_significance' => '学問の神様として全国の学生に信仰される、日本の教育文化の聖地'
            ],
            502 => [
                'name' => '福岡城跡',
                'description' => '黒田如水・長政父子が築いた福岡藩52万石の居城跡。',
                'history' => '1601年から7年をかけて黒田如水・長政父子によって築城された福岡城は、九州最大の城郭でした。現在は舞鶴公園として整備され、桜の名所としても親しまれています。',
                'episodes' => [
                    '黒田如水は豊臣秀吉の軍師として活躍し、息子の長政は関ヶ原の戦いで徳川方の勝利に貢献しました。',
                    '福岡城には47の櫓があったとされ、その規模の大きさが偲ばれます。',
                    '春には約1,000本の桜が咲き誇り、福岡市民に愛される花見スポットとなっています。'
                ],
                'highlights' => ['天守台跡', '多聞櫓', '下之橋御門', '桜の名所', '福岡市街の眺望'],
                'cultural_significance' => '黒田家の九州統治の拠点として、福岡の礎を築いた歴史的遺産'
            ],
            503 => [
                'name' => '博多駅',
                'description' => '九州の玄関口として機能する巨大ターミナル駅。グルメとショッピングの一大拠点。',
                'history' => '1889年に九州鉄道の駅として開業した博多駅は、九州の鉄道網の起点として発展してきました。2011年の九州新幹線全線開業に合わせて大規模な再開発が行われ、現在の巨大複合施設となりました。',
                'episodes' => [
                    '博多駅ビルには約230の専門店が入り、博多ラーメンや明太子など福岡グルメの聖地となっています。',
                    '屋上には鉄道神社があり、旅の安全を祈願する参拝者が訪れます。',
                    '駅の愛称「はかた駅」は、博多織や博多人形など伝統工芸の街「博多」に由来しています。'
                ],
                'highlights' => ['博多ラーメン街道', '博多阪急', 'アミュプラザ博多', '屋上庭園', '九州の玄関口'],
                'cultural_significance' => '九州と本州を結ぶ交通の要衝として、現代の九州経済・文化の発信拠点'
            ],
            504 => [
                'name' => 'キャナルシティ博多',
                'description' => '運河が流れる開放的なショッピングモール。都市の劇場をコンセプトとした複合商業施設。',
                'history' => '1996年に開業したキャナルシティ博多は、アメリカの建築家ジョン・ジャーディが設計した「都市の劇場」をコンセプトとした革新的な商業施設です。中央を流れる運河と噴水ショーが印象的で、九州最大級のエンターテイメント施設となっています。',
                'episodes' => [
                    '建物の中央を流れる運河では、定期的に音楽と光の噴水ショーが開催され、多くの観光客を魅了しています。',
                    'ラーメンスタジアムでは全国の有名ラーメン店が集結し、ラーメンの食べ比べが楽しめます。',
                    '博多座では歌舞伎からミュージカルまで、年間を通じて様々な舞台芸術が上演されています。'
                ],
                'highlights' => ['運河と噴水ショー', 'ラーメンスタジアム', '博多座', 'ファッション専門店', '映画館'],
                'cultural_significance' => '九州の商業・エンターテイメントの新しい形を提示した、現代都市文化の象徴'
            ],
            505 => [
                'name' => '櫛田神社',
                'description' => '博多総鎮守として親しまれる古社。博多祇園山笠の出発点として全国的に有名。',
                'history' => '天平宝字元年（757年）に創建されたと伝えられる櫛田神社は、博多の総鎮守として長い間崇敬されてきました。特に博多祇園山笠との結びつきが深く、毎年7月の山笠期間中は祭りの中心地となります。',
                'episodes' => [
                    '境内には博多祇園山笠の実物大飾り山が常設展示され、一年中山笠の迫力を感じることができます。',
                    '「お櫛田さん」の愛称で親しまれ、博多っ子にとって心のふるさとのような存在です。',
                    '境内の霊水「不老長寿の水」は、飲むと長生きできると言われています。'
                ],
                'highlights' => ['飾り山常設展示', '博多祇園山笠', '不老長寿の霊水', '夫婦恵比須神社', '博多塀'],
                'cultural_significance' => '博多祇園山笠の聖地として、博多の伝統文化と地域アイデンティティの核心'
            ],
            506 => [
                'name' => '福岡PayPayドーム',
                'description' => '日本初の開閉式屋根を持つドーム球場。福岡ソフトバンクホークスの本拠地。',
                'history' => '1993年に「福岡ドーム」として開業し、日本初の開閉式屋根を持つドーム球場として注目を集めました。2005年のソフトバンク球団買収を経て、2020年に「PayPayドーム」と改称され、九州のスポーツ・エンターテイメントの拠点となっています。',
                'episodes' => [
                    '開閉式の屋根により、天候に左右されず快適に野球観戦やイベントを楽しむことができます。',
                    '王貞治ベースボールミュージアムでは、世界のホームラン王の偉業を展示しています。',
                    '野球シーズン以外にも、国内外の有名アーティストのコンサート会場として多くの観客を魅了しています。'
                ],
                'highlights' => ['開閉式屋根', '福岡ソフトバンクホークス', '王貞治ベースボールミュージアム', 'コンサート会場', 'ホークスタウンモール'],
                'cultural_significance' => '九州のプロ野球文化の中心地として、スポーツとエンターテイメントの融合を象徴'
            ],
            
            // 広島県 (600-699)
            601 => [
                'name' => '原爆ドーム',
                'description' => '広島に投下された原子爆弾の悲惨さを今に伝える平和の象徴。',
                'history' => '1915年に広島県産業奨励館として建設された建物で、1945年8月6日の原爆投下により被爆しました。現在は核兵器廃絶と世界平和を訴える象徴として、世界遺産に登録されています。',
                'episodes' => [
                    '原爆投下時、この建物の真上約600メートルで爆発が起こりましたが、中央のドーム部分が奇跡的に残りました。',
                    '被爆後、この建物は「原爆ドーム」と呼ばれるようになり、戦争の悲惨さを物語る貴重な遺構となりました。',
                    '毎年8月6日の平和記念式典では、世界中から平和を願う人々が集まります。'
                ],
                'highlights' => ['被爆遺構', '平和記念公園', '平和記念資料館', '慰霊碑', '平和の灯'],
                'cultural_significance' => '人類初の原爆被爆の惨禍を伝え、世界平和を訴える人類共通の遺産'
            ],
            602 => [
                'name' => '厳島神宮',
                'description' => '海に浮かぶ朱色の大鳥居で有名な日本三景の一つ。',
                'history' => '推古天皇元年（593年）の創建と伝えられる古社で、平清盛によって現在の規模に整備されました。海に浮かぶ神殿は「安芸の宮島」として日本三景の一つに数えられています。',
                'episodes' => [
                    '平清盛は厳島神社を平家の氏神として崇敬し、現在見られる海上神殿の基礎を築きました。',
                    '満潮時には神殿全体が海に浮かんで見え、干潮時には歩いて大鳥居まで行くことができます。',
                    '宮島には神の使いとされる鹿が約600頭生息しており、観光客に親しまれています。'
                ],
                'highlights' => ['海上の大鳥居', '厳島神社本殿', '五重塔', '千畳閣', '宮島の鹿'],
                'cultural_significance' => '平安時代の優美な海上神殿として、日本建築美の粋を集めた世界遺産'
            ],
            603 => [
                'name' => '広島城',
                'description' => '毛利輝元が築城した広島藩の居城。原爆により倒壊したが復元された。',
                'history' => '1589年に毛利輝元によって築城された広島城は、関ヶ原の戦い後は福島正則、浅野家が城主となりました。1945年の原爆により倒壊しましたが、1958年に天守閣が復元されました。',
                'episodes' => [
                    '「鯉城」の愛称で親しまれ、この名前が広島東洋カープの球団名の由来になりました。',
                    '築城当時は海に面した水城で、毛利水軍の拠点でもありました。',
                    '現在の天守閣は鉄筋コンクリート造りで、内部は歴史博物館として利用されています。'
                ],
                'highlights' => ['復元天守閣', '二の丸復元建物', '広島城跡', '護国神社', '桜の名所'],
                'cultural_significance' => '戦争の悲劇を乗り越えて復活した、広島の復興と平和への願いの象徴'
            ],
            
            // 福島県 (700-799)
            701 => [
                'name' => '会津若松城',
                'description' => '戊辰戦争の舞台となった会津藩の居城。鶴ヶ城の名で親しまれる。',
                'history' => '1384年に築城された会津若松城は、戊辰戦争では新政府軍の激しい攻撃に1か月間耐え抜きました。明治時代に取り壊されましたが、1965年に復元され、現在は会津の象徴となっています。',
                'episodes' => [
                    '白虎隊の悲劇で知られる戊辰戦争では、籠城戦の末に開城しました。',
                    '八重の桜で有名な新島八重（山本八重）が鉄砲隊として活躍した舞台でもあります。',
                    '赤瓦の天守閣は全国でも珍しく、会津の厳しい冬に耐える工夫が施されています。'
                ],
                'highlights' => ['赤瓦の天守閣', '本丸跡', '茶室麟閣', '白虎隊記念館', '桜の名所'],
                'cultural_significance' => '会津武士道精神と戊辰戦争の歴史を物語る、東北の誇りの象徴'
            ],
            702 => [
                'name' => '五色沼',
                'description' => '磐梯山の噴火でできた美しい湖沼群。エメラルドグリーンの神秘的な色彩。',
                'history' => '1888年の磐梯山噴火により形成された湖沼群で、大小約300の湖沼があります。最も有名な毘沙門沼をはじめ、それぞれ異なる美しい色彩を見せることから五色沼と呼ばれています。',
                'episodes' => [
                    '各沼の色が違うのは、含まれる鉱物やプランクトンの種類、水深によるものです。',
                    'ハートの形をした赤沼は恋愛成就のパワースポットとして人気です。',
                    '四季を通じて美しく、特に紅葉シーズンの景色は絶景として知られています。'
                ],
                'highlights' => ['毘沙門沼', '青沼', '赤沼', '弁天沼', '散策路'],
                'cultural_significance' => '自然の造形美の神秘を体感できる、福島の代表的な自然景観'
            ],
            
            // 愛媛県 (800-899)
            801 => [
                'name' => '道後温泉',
                'description' => '日本最古の温泉の一つ。夏目漱石「坊っちゃん」の舞台として有名。',
                'history' => '約3000年の歴史を持つとされる日本最古級の温泉で、聖徳太子や夏目漱石も入浴したと伝えられています。道後温泉本館は1894年に建築された木造三層楼で、国の重要文化財に指定されています。',
                'episodes' => [
                    '夏目漱石の小説「坊っちゃん」の舞台として全国的に有名になりました。',
                    '道後温泉本館は宮崎駿監督の「千と千尋の神隠し」の油屋のモデルの一つとされています。',
                    '皇室専用浴室「又新殿」があり、明治天皇をはじめ多くの皇族が利用されました。'
                ],
                'highlights' => ['道後温泉本館', '又新殿', '霊の湯', '神の湯', '道後公園'],
                'cultural_significance' => '日本の温泉文化の原点として、文学と歴史に彩られた聖地'
            ],
            802 => [
                'name' => '松山城',
                'description' => '加藤嘉明が築城した現存12天守の一つ。松山市のシンボル。',
                'history' => '1602年に加藤嘉明が築城を開始し、25年の歳月をかけて完成した平山城です。現在の天守閣は1854年に再建されたもので、現存12天守の一つとして国宝に指定されています。',
                'episodes' => [
                    '築城名人として知られる加藤嘉明が設計した堅固な城で、攻城戦で落城したことがありません。',
                    'ロープウェイとリフトで本丸まで上がることができ、瀬戸内海の絶景を楽しめます。',
                    '桜の名所としても有名で、春には約200本の桜が城を彩ります。'
                ],
                'highlights' => ['現存天守', 'ロープウェイ', '瀬戸内海の眺望', '桜の名所', '石垣'],
                'cultural_significance' => '現存天守として四国の誇りを象徴し、城郭建築の粋を今に伝える文化財'
            ],
            
            // 新潟県 (1000-1099)
            1001 => [
                'name' => '佐渡島',
                'description' => '日本海に浮かぶ金山で有名な離島。豊かな自然と伝統文化が息づく島。',
                'history' => '佐渡島は平安時代から流刑地として使われ、順徳天皇や日蓮聖人も配流されました。江戸時代には佐渡金山が発見され、徳川幕府の重要な財源となりました。金山最盛期の17世紀には人口10万人を超え、江戸に次ぐ都市でした。',
                'episodes' => [
                    '佐渡金山では江戸時代の400年間で約78トンの金が採掘され、小判約400万枚分に相当します。',
                    '能楽は佐渡に流された世阿弥により島に根付き、現在も島内に30以上の能舞台が残されています。',
                    '朱鷺（トキ）の最後の野生個体「キン」が1981年に捕獲された地で、現在は野生復帰事業が進められています。',
                    '太鼓芸能集団「鼓童」の本拠地として、毎年「アース・セレブレーション」が開催されます。'
                ],
                'highlights' => ['佐渡金山遺跡', '朱鷺の森公園', '能楽の郷', '千枚田', '尖閣湾'],
                'cultural_significance' => '日本の鉱山技術と流人文化が生んだ独特の島嶼文化の宝庫として、世界遺産登録を目指す貴重な文化遺産'
            ],
            1002 => [
                'name' => '弥彦神社',
                'description' => '越後国一宮として2400年以上の歴史を持つ古社。弥彦山を御神体とする格式高い神社。',
                'history' => '紀元前392年の創建と伝えられる古社で、天香山命（あめのかごやまのみこと）を祀っています。越後国の開拓に尽力した神として信仰され、古くから「おやひこさま」と親しまれてきました。源義家や上杉謙信も戦勝祈願に訪れた記録が残っています。',
                'episodes' => [
                    '競輪発祥の地として知られ、1948年に日本初の競輪場が開設されました。',
                    '弥彦菊まつりは大正5年から始まり、現在では日本有数の菊の展示会として知られています。',
                    '弥彦山山頂からは越後平野と日本海を一望でき、古くから越後富士とも呼ばれました。',
                    '正月三が日の参拝者数は約25万人で、新潟県内では最多の初詣スポットです。'
                ],
                'highlights' => ['本殿と拝殿', '弥彦山ロープウェイ', '菊まつり', '宝物殿', '玉の橋'],
                'cultural_significance' => '越後国開拓の祖神を祀る聖地として、新潟県民の精神的支柱となる重要な神社'
            ],
            1003 => [
                'name' => '苗場スキー場',
                'description' => '上質なパウダースノーで知られる日本屈指のスキーリゾート。音楽フェスの聖地。',
                'history' => '1961年に開業した苗場スキー場は、プリンスホテルグループが開発した本格的なスキーリゾートです。1970年代からウィンタースポーツブームの中心地となり、1982年からは「フジロックフェスティバル」の会場として音楽ファンにも愛される場所になりました。',
                'episodes' => [
                    '世界最長5,481メートルのドラゴンドラ（ゴンドラ）が苗場と田代を結んでいます。',
                    'フジロックフェスティバルは1997年から開催され、夏の苗場を世界的な音楽の聖地にしました。',
                    '標高1,789メートルの苗場山は日本百名山の一つで、山頂の湿原は絶景スポットです。',
                    'バブル期には「苗場で恋して軽井沢で結婚する」という言葉が流行しました。'
                ],
                'highlights' => ['世界最長ゴンドラ', 'フジロック会場', '苗場プリンスホテル', '苗場山登山', '田代湖'],
                'cultural_significance' => '日本のスキー文化と音楽フェス文化を牽引するリゾート地として、世代を超えて愛される場所'
            ],
            
            // 山口県 (1100-1199)
            1101 => [
                'name' => '錦帯橋',
                'description' => '日本三名橋の一つ。5連のアーチが美しい木造橋。',
                'history' => '1673年に岩国藩主吉川広嘉によって架橋された錦帯橋は、釘を一本も使わずに造られた木造アーチ橋の傑作です。度重なる洪水に耐える独特の構造で設計され、現在は日本三名橋の一つに数えられています。',
                'episodes' => [
                    '5連のアーチ構造は当時の技術の粋を集めた設計で、洪水時には橋脚が水圧を分散させます。',
                    '初代錦帯橋は完成から1年で流失しましたが、2代目以降は276年間流されることがありませんでした。',
                    '橋の名前は「錦の帯のように美しい」ことから名付けられたと言われています。',
                    '年間約120万人が訪れ、春の桜、夏の鵜飼い、秋の紅葉と四季を通じて美しい景観を楽しめます。'
                ],
                'highlights' => ['5連アーチ橋', '岩国城', '錦川の清流', '桜並木', '鵜飼い見学'],
                'cultural_significance' => '江戸時代の土木技術の最高傑作として、日本の橋梁技術の発展を象徴する重要文化財'
            ],
            1102 => [
                'name' => '秋芳洞',
                'description' => '日本最大級の鍾乳洞。美しい石灰岩の造形美で知られる地底の宮殿。',
                'history' => '約3億年前の古生代に形成された石灰岩台地「秋吉台」の地下にある鍾乳洞で、総延長は約10.7キロメートルに及びます。洞内の気温は年間を通じて17度に保たれ、観光洞として約1キロメートルが公開されています。',
                'episodes' => [
                    '黄金柱と呼ばれる高さ15メートルの石筍は、数万年かけて形成された自然の芸術作品です。',
                    '百枚皿と呼ばれる段々状の石灰華段丘は、世界でも珍しい地下の棚田のような景観です。',
                    '洞内を流れる川は「コウモリ川」と呼ばれ、多数のコウモリが生息している貴重な生態系です。',
                    '1922年に国の天然記念物に指定され、1955年には特別天然記念物に格上げされました。'
                ],
                'highlights' => ['黄金柱', '百枚皿', 'コウモリ川', '千町田', '広庭'],
                'cultural_significance' => '地球の歴史と自然の造形美を体感できる学術的価値の高い天然記念物'
            ],
            1103 => [
                'name' => '萩城下町',
                'description' => '江戸時代の面影を残す武家屋敷群。明治維新の志士たちが育った城下町。',
                'history' => '1604年に毛利輝元が萩城を築城して以来、約260年間長州藩36万石の城下町として栄えました。幕末には吉田松陰、高杉晋作、木戸孝允など明治維新の立役者を多数輩出し、「明治維新胎動の地」と呼ばれています。',
                'episodes' => [
                    '吉田松陰が主宰した松下村塾からは、明治政府の重要人物が多数巣立ちました。',
                    '高杉晋作が結成した奇兵隊は、身分を問わず志ある者を集めた革新的な軍事組織でした。',
                    '萩反射炉は1856年に建設された日本初の実用的な反射炉で、現在は世界遺産に登録されています。',
                    '城下町の町割りは江戸時代のまま保存され、約400年前の都市計画を現在も見ることができます。'
                ],
                'highlights' => ['松下村塾', '萩反射炉', '武家屋敷', '萩城跡', '明倫学舎'],
                'cultural_significance' => '明治維新発祥の地として日本近代化の出発点を示す貴重な歴史的景観'
            ],
            
            // 徳島県 (1200-1299)
            1201 => [
                'name' => '鳴門の渦潮',
                'description' => '世界最大級の自然現象。潮の干満によって生じる巨大な渦潮。',
                'history' => '鳴門海峡は幅約1.3キロメートルの狭い海峡で、瀬戸内海と太平洋の潮位差により世界最大級の渦潮が発生します。この現象は古くから知られており、平安時代の文献にも記録が残されています。',
                'episodes' => [
                    '最大時速20キロメートルで流れる激流により、直径約20メートルの巨大な渦潮が発生します。',
                    '大鳴門橋の遊歩道「渦の道」からは、海上45メートルの高さから渦潮を見下ろすことができます。',
                    '年間約100万人の観光客が訪れ、観潮船からの間近な観察も人気です。',
                    '潮見表に基づく最適な観潮時間があり、大潮の時期が最も迫力ある渦潮を見ることができます。'
                ],
                'highlights' => ['巨大渦潮', '大鳴門橋', '渦の道', '観潮船', '鳴門公園'],
                'cultural_significance' => '自然の力強さと美しさを体感できる世界的に珍しい海洋現象として、地球の神秘を伝える自然遺産'
            ],
            1202 => [
                'name' => '阿波踊り会館',
                'description' => '400年以上の歴史を持つ阿波踊りの文化拠点。年中踊りを体験できる施設。',
                'history' => '阿波踊りは1586年に徳島城の完成を祝って踊られたのが起源とされています。阿波踊り会館は1999年に開館し、阿波踊りの歴史と文化を年間を通じて体験できる施設として、伝統芸能の継承と発展に貢献しています。',
                'episodes' => [
                    '「踊る阿呆に見る阿呆、同じ阿呆なら踊らにゃ損々」の有名な囃子詞で知られています。',
                    '毎年8月の阿波踊り期間中には約130万人の観光客が徳島を訪れます。',
                    '女踊りの優雅さと男踊りの力強さが織りなす美しい舞踊は、日本を代表する民俗芸能です。',
                    '有名連（踊りのグループ）は技術の高さで知られ、その踊りは芸術の域に達しています。'
                ],
                'highlights' => ['阿波踊り公演', '踊り体験', '阿波踊りミュージアム', '眉山ロープウェイ', '有名連の踊り'],
                'cultural_significance' => '400年の伝統を持つ阿波踊り文化の継承拠点として、徳島県民の誇りと日本の民俗芸能の粋を体現'
            ],
            1203 => [
                'name' => '大塚国際美術館',
                'description' => '世界の名画を陶板で原寸大に再現した世界唯一の美術館。',
                'history' => '1998年に開館した大塚国際美術館は、古代壁画から現代絵画まで1,000点以上の西洋名画を陶板技術で原寸大に再現展示している世界唯一の美術館です。大塚製薬グループの技術力を結集した文化事業として設立されました。',
                'episodes' => [
                    'ミケランジェロの「システィーナ礼拝堂」は実物と同じ環境で再現され、仰向けになって天井画を鑑賞できます。',
                    'モネの「大睡蓮」は地下3階の約200平方メートルの展示室に原寸大で再現されています。',
                    '陶板の耐久性は2000年以上とされ、色褪せることなく永続的に名画を保存できます。',
                    '年間約40万人が来館し、世界の名画を一箇所で鑑賞できる唯一の場所として注目されています。'
                ],
                'highlights' => ['システィーナ礼拝堂', 'モネの大睡蓮', '陶板名画', 'スクロヴェーニ礼拝堂', '古代遺跡'],
                'cultural_significance' => '最新技術により世界の文化遺産を永続保存し、芸術の普及と教育に貢献する革新的な文化施設'
            ],
            
            // 鹿児島県 (1300-1399)
            1301 => [
                'name' => '桜島',
                'description' => '鹿児島のシンボル的存在の活火山。美しい山容と火山活動で有名。',
                'history' => '桜島は約2万6千年前に誕生した活火山で、1914年の大正大噴火では大隅半島と陸続きになりました。現在も活発な火山活動を続けており、年間約1000回の噴火を記録する世界有数の活火山として、火山研究の重要な拠点となっています。',
                'episodes' => [
                    '大正大噴火では約30億トンの溶岩が流出し、それまで島だった桜島が大隅半島と陸続きになりました。',
                    '世界最大級の大根「桜島大根」は直径40センチ、重さ30キロにもなる特産品です。',
                    '湯之平展望所からは間近に見る火口と噴煙、眼下に広がる錦江湾の絶景を楽しめます。',
                    '桜島フェリーは24時間運航しており、船上から見る桜島は迫力満点です。'
                ],
                'highlights' => ['活火山の噴煙', '湯之平展望所', '溶岩なぎさ公園', '桜島フェリー', '黒神埋没鳥居'],
                'cultural_significance' => '活火山と共生する鹿児島の象徴として、火山の恵みと脅威を伝える自然の教科書'
            ],
            1302 => [
                'name' => '屋久島',
                'description' => '樹齢数千年の屋久杉で有名な世界遺産の島。太古の森が残る神秘の島。',
                'history' => '屋久島は1993年に日本初の世界自然遺産に登録された島で、樹齢1000年以上の屋久杉が自生する貴重な生態系を保持しています。標高1936メートルの宮之浦岳を最高峰とし、「月に35日雨が降る」と言われるほど多雨な気候が原始林を育んできました。',
                'episodes' => [
                    '縄文杉は推定樹齢2170～7200年とされ、発見当時は世界最古の樹木と考えられていました。',
                    'ウィルソン株は豊臣秀吉の命令で伐採された杉の切り株で、内部はハート型に見えることで有名です。',
                    '宮崎駿監督の「もののけ姫」の森のモデルとされ、苔むした原始林は神秘的な美しさです。',
                    '島の面積の約20％が世界遺産地域に指定され、厳格な自然保護が行われています。'
                ],
                'highlights' => ['縄文杉', 'ウィルソン株', '白谷雲水峡', '宮之浦岳', '永田いなか浜'],
                'cultural_significance' => '太古から続く原始の自然と人間の共生を示す世界的に貴重な自然遺産'
            ],
            1303 => [
                'name' => '霧島神宮',
                'description' => '天孫降臨の地に建つ由緒ある神社。霧島連山の自然に囲まれた神聖な場所。',
                'history' => '霧島神宮は6世紀に創建されたと伝えられる古社で、天孫降臨神話のニニギノミコトを主祭神として祀っています。現在の社殿は1715年に島津吉貴によって建立されたもので、朱塗りの美しい社殿は「西の日光」とも称されています。',
                'episodes' => [
                    'ニニギノミコトが高天原から降臨した地とされる高千穂峰が御神体山として崇められています。',
                    '坂本龍馬が新婚旅行で妻のお龍と訪れ、日本初の新婚旅行地として知られています。',
                    '霧島神宮の大杉は樹齢約800年、高さ35メートルの御神木として参拝者に親しまれています。',
                    '毎年11月10日の天孫降臨祭では、神楽や流鏑馬などの奉納行事が行われます。'
                ],
                'highlights' => ['朱塗りの社殿', '霧島神宮大杉', '高千穂峰', '神楽殿', '霧島温泉郷'],
                'cultural_significance' => '天孫降臨神話の聖地として、日本神話と霧島の自然が織りなす神聖な空間'
            ]
        ];

        // 詳細データがある場合はそれを返す
        if (isset($detailedSpots[$spotId])) {
            return array_merge($detailedSpots[$spotId], ['id' => $spotId]);
        }

        // フォールバック用の基本的なスポット名マッピング（名前のみ）
        $basicSpotNames = [
            403 => 'トヨタ産業技術記念館',
            503 => '博多駅',
            603 => '広島城',
            701 => '会津若松城', 702 => '五色沼', 703 => 'スパリゾートハワイアンズ',
            801 => '松山城', 802 => '道後温泉', 803 => 'しまなみ海道',
            901 => '川越', 902 => '秩父神社', 903 => '長瀞',
            1001 => '佐渡島', 1002 => '弥彦神社', 1003 => '苗場スキー場',
            1101 => '錦帯橋', 1102 => '秋芳洞', 1103 => '萩城下町',
            1201 => '鳴門の渦潮', 1202 => '阿波踊り会館', 1203 => '大塚国際美術館',
            1301 => '桜島', 1302 => '屋久島', 1303 => '霧島神宮',
        ];

        $name = $basicSpotNames[$spotId] ?? "観光地#{$spotId}";
        
        return [
            'id' => $spotId,
            'name' => $name,
            'description' => "{$name}は、日本を代表する素晴らしい観光地です。歴史と文化が息づく魅力的な場所で、多くの訪問者に愛され続けています。",
            'history' => "長い歴史を持つ{$name}は、その地域の文化と伝統を象徴する重要な場所として、代々受け継がれてきました。",
            'episodes' => [
                "{$name}には多くの興味深いエピソードがあります。",
                "訪れる人々に感動と発見を提供し続けています。"
            ],
            'highlights' => ['歴史的価値', '文化的意義', '美しい景観'],
            'cultural_significance' => "地域の文化と歴史を代表する重要な観光地として、多くの人々に愛されています。",
        ];
    }

    /**
     * 音声ガイド用テキストを生成
     *
     * @param array $spotData
     * @param string $language
     * @return string
     */
    private function generateGuideText(array $spotData, string $language = 'ja'): string
    {
        if ($language === 'en') {
            $episodes = isset($spotData['episodes']) && is_array($spotData['episodes']) ? ' ' . implode(' ', $spotData['episodes']) : '';
            $cultural = isset($spotData['cultural_significance']) ? ' This place represents: ' . $spotData['cultural_significance'] : '';
            $highlights = isset($spotData['highlights']) && is_array($spotData['highlights']) ? implode(', ', $spotData['highlights']) : 'various attractions';
            $history = isset($spotData['history']) ? $spotData['history'] : '';
            
            return sprintf(
                "Welcome to %s. %s %s%s Here are the main highlights: %s.%s Thank you for visiting this remarkable destination!",
                $spotData['name'],
                $spotData['description'],
                $history,
                $episodes,
                $highlights,
                $cultural
            );
        }

        // 日本語の詳細な音声ガイド
        $guideText = "ようこそ、{$spotData['name']}へお越しくださいました。";
        
        // 基本説明
        $guideText .= " {$spotData['description']}";
        
        // 歴史的背景
        if (!empty($spotData['history'])) {
            $guideText .= " それでは、この場所の歴史についてお話ししましょう。{$spotData['history']}";
        }
        
        // エピソード
        if (!empty($spotData['episodes']) && is_array($spotData['episodes'])) {
            $guideText .= " 興味深いエピソードをご紹介します。";
            foreach ($spotData['episodes'] as $index => $episode) {
                $guideText .= " " . ($index + 1) . "つ目として、{$episode}";
            }
        }
        
        // 見どころ
        if (!empty($spotData['highlights']) && is_array($spotData['highlights'])) {
            $guideText .= " こちらでの主な見どころは、" . implode('、', $spotData['highlights']) . "となっております。";
        }
        
        // 文化的意義
        if (!empty($spotData['cultural_significance'])) {
            $guideText .= " この場所は、{$spotData['cultural_significance']}として、多くの人々に愛され続けています。";
        }
        
        $guideText .= " どうぞごゆっくりとお楽しみください。";
        
        return $guideText;
    }
}